<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Regresión logística</title>

<script src="site_libs/header-attrs-2.9/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="tutorial.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ANALITICA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Estadística básica
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="E1-Introducción.html">¿Qué es la Estadística?</a>
    </li>
    <li>
      <a href="E2-Historia.html">Historia breve de la estadística cuantitativa</a>
    </li>
    <li>
      <a href="E3-TallerRFE_I.html">Introducción a R, Rstudio y RMarkdown</a>
    </li>
    <li>
      <a href="E4-Graficos.html">Explorando los datos con gráficos</a>
    </li>
    <li>
      <a href="E5-supuestos.html">Los Supuestos de las pruebas paramétricas</a>
    </li>
    <li>
      <a href="E6-TallerRFE_II.html">Regresión simple y ANOVA</a>
    </li>
    <li>
      <a href="E7-TRAvanzado.html">Modelos Lineales</a>
    </li>
    <li>
      <a href="E8-Tipos_de_Datos.html">Tipos de Datos</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Visualización
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="G1-ggplot2.html">Qué es la visualización de datos y ejemplos historicos</a>
    </li>
    <li>
      <a href="G2-Errores-tipicos-en-la-visualizacion.html">Errores típicos en la visualización</a>
    </li>
    <li>
      <a href="G3-Graficos-por-conteos.html">Gráficos para conteos</a>
    </li>
    <li>
      <a href="G4-Grafico-de-puntos-de-Wilkinson.html">Gráficos de puntos de Wilkinson</a>
    </li>
    <li>
      <a href="G5_geom_area_densidad_freqpoly.html">Gráficos de area y densidad</a>
    </li>
    <li>
      <a href="G6_geom_histogram.html">Histogramas</a>
    </li>
    <li>
      <a href="G7_geom_bar.html">Gráficos de barras</a>
    </li>
    <li>
      <a href="G8_geom_boxplot_geom_violin.html">Gráficos de caja y de violín</a>
    </li>
    <li>
      <a href="G9_Facet_Grid.html">Facet Grid</a>
    </li>
    <li>
      <a href="G10_Facet_wrap.html">Facet Wrap</a>
    </li>
    <li>
      <a href="G11_EVALUANDO_SUPUESTOS.html">Evaluando Supuestos</a>
    </li>
    <li>
      <a href="G12_Mapas_Calor.html">Mapas de Calor</a>
    </li>
    <li>
      <a href="G13_geom_line.html">Gráficos con lineas</a>
    </li>
    <li>
      <a href="G14_geom_point_geom_jitter.html">Geom_point y geom_jitter</a>
    </li>
    <li>
      <a href="G15_gganimate.html">Gráficos animados (en movimiento) 1</a>
    </li>
    <li>
      <a href="G15b_gganimate.html">Gráficos animados (en movimiento) 2</a>
    </li>
    <li>
      <a href="G15c_gganimate_barras.html">Gráficos animados (en movimiento) 3</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Talleres
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Documento_RMarkdown-ed">Una breve introducción a RMarkdown</a>
    </li>
    <li>
      <a href="Documento_dplyr">Una breve introducción a dplyr</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Taller para Facultad
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TF_1_Descripción.html">Descripción del taller</a>
    </li>
    <li>
      <a href="TF1_Regresion_Lineal.html">Regresión Lineal</a>
    </li>
    <li>
      <a href="TF2_Regresion_Cuadratica_otro.html">Regresión no lineal</a>
    </li>
    <li>
      <a href="TF3_Regresion_Multiples.html">Regresión Multiples</a>
    </li>
    <li>
      <a href="TF4_GLM.html">Modelos Lineales Generalizados</a>
    </li>
    <li>
      <a href="TF5_Regresion_logistica.html">Regresion Logística</a>
    </li>
    <li>
      <a href="TF6_Regresion_Poisson.html">Regresión Poisson</a>
    </li>
    <li>
      <a href="TF7_Regresion_beta.html">Regresión Beta</a>
    </li>
    <li>
      <a href="TF8_Akaike_Information_Criterion.html">Criterio de Selección</a>
    </li>
    <li>
      <a href="TF9_Ejercicio_Practica.html">Ejercicios de Practica</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Los Datos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Datos.html">Los Datos</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Regresión logística</h1>

</div>


<style>
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    background-color: #437d66;
}
</style>
<p><img src="Graficos/Analitica.png" width="50%" /><img src="Graficos/UPR_IPERT_logo.png" width="50%" /></p>
<hr />
<p>Cargamos los paquetes requeridos:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<hr />
<div id="regessión-logística" class="section level2">
<h2>Regessión Logística</h2>
<p>La regresión logística es el procedimiento para evaluar el efecto de una variable continua sobre una variable discreta binaria. En este caso la variable discreta está limitada a solamente dos alternativas. Por ejemplo: si o no, vivo o muerto, presente o ausente, tiene flores o no tiene flores, estar infectado o no estar infectado con el COVID-19, o Trump o Biden. Típicamente se codifica con valores numéricos. En uno de los estados se la asigna un “0” y la otra se la asigna un “1”.</p>
<p>En el siguiente dataset ficticio la variable continua representa el tamaño de 20 bacterias (en µm), y la variable discreta binomial representa si esta bacteria hizo fisión (1) o no (0).</p>
<hr />
</div>
<div id="ejemplo-de-un-patrón-casi-perfecto" class="section level2">
<h2>Ejemplo de un patrón casi perfecto</h2>
<p>Con la siguiente gráfica se observa que cuando las bacterias son muy pequeñas no ocurre fisión y cuando miden 9 µm o más hay una fisión binaria. Si una bacteria tiene un tamaño de 10 µm tiene una probabilidad de fisionarse de 50%.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>continuous<span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">2</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>binomial<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span><span class="fu">data.frame</span>(continuous,binomial)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##    continuous binomial
## 1           1        0
## 2           2        0
## 3           3        0
## 4           4        0
## 5           5        0
## 6           6        0
## 7           7        0
## 8           8        0
## 9           9        1
## 10         10        0
## 11         11        1
## 12         12        1
## 13         13        1
## 14         14        1
## 15         15        1
## 16         16        1
## 17         17        1
## 18         18        1
## 19         19        1
## 20         20        1
## 21          1        0
## 22          2        0
## 23          3        0
## 24          4        0
## 25          5        0
## 26          6        0
## 27          7        0
## 28          8        0
## 29          9        0
## 30         10        0
## 31         11        1
## 32         12        1
## 33         13        1
## 34         14        1
## 35         15        1
## 36         16        1
## 37         17        1
## 38         18        1
## 39         19        1
## 40         20        1</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># producción del gráfico</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( df, <span class="fu">aes</span>(<span class="at">x=</span>continuous, <span class="at">y=</span>binomial)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>), <span class="at">se=</span>F) </span></code></pre></div>
<p><img src="TF5_Regresion_logistica_files/figure-html/perfect%20logistic%20regression-1.png" width="672" /></p>
<hr />
<div id="preparando-el-modelo" class="section level3">
<h3>Preparando el modelo</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">glm</span>(binomial<span class="sc">~</span>continuous, <span class="at">data=</span> df, <span class="at">family =</span> <span class="fu">binomial</span>())</span></code></pre></div>
</div>
<div id="evaluando-el-modelo" class="section level3">
<h3>Evaluando el modelo</h3>
<p>Igual como en una regresión lineal se evalúa el intercepto y los coeficientes de las variables continuas. En este caso tenemos solamente una variable continua. El <strong>Estimate</strong> son los coeficientes en la escala <span class="math inline">\(logit(p)=\log\frac{p}{1-p}\)</span>, donde las <span class="math inline">\(p&#39;s\)</span> representan las probabilidades de estar en el estado “1”. El valor de <span class="math inline">\(p = Pr(&gt;|z|)\)</span> es la probabilidad de que el intercepto o las pendientes sean diferentes de cero.</p>
<p>Los valores de <strong>Null Deviance</strong> y <strong>Residual Deviance</strong> son índices <strong>Bondad de ajuste</strong> o sea del <em>goodness of fit</em> del modelo. Valores grandes siempre sugieren que el modelo no es bueno.</p>
<p>La desviación nula (Null Deviance) muestra qué tan bien la variable de respuesta es predicha por un modelo que incluye solamente el intercepto (gran media). La desviación de los residuales donde incluye las de variables independientes.</p>
<p>En nuestro modelo ficticio, la <strong>desviación nula</strong>, el <em>Null Deviance</em> es bien alto (55.35), pero cuando se incluye la variable independiente la <strong>desviación residual</strong> (<em>residual deviance</em>) baja mucho (7.83). Esto surgiere que el modelo no es muy bueno a predecir si las células van tener una fisión, al contrario el tamaño es una variable que explica gran parte de la variación para predecir la probabilidad de fisión binaria.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = binomial ~ continuous, family = binomial(), data = df)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.17741  -0.02124   0.00032   0.02124   1.92375  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept) -16.7941     8.5378  -1.967   0.0492 *
## continuous    1.6794     0.8489   1.978   0.0479 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 55.3517  on 39  degrees of freedom
## Residual deviance:  7.8364  on 38  degrees of freedom
## AIC: 11.836
## 
## Number of Fisher Scoring iterations: 9</code></pre>
<hr />
</div>
</div>
<div id="modelo-lineal-generalizado" class="section level1">
<h1>Modelo Lineal Generalizado</h1>
<p>En este modulo se hace introduce otro tipo de herramienta para el análisis de datos, denominado <strong>Modelo Lineal Generalizado, GLM</strong>. Lo interesante de este método hay múltiples opciones para el análisis a pesar de que la variable de respuesta no tenga una distribución normal. En este módulo solamente se estará presentando el tipo de datos donde la variable de respuesta (Y) es binomial.</p>
<hr />
<div id="hay-tres-componentes-en-cualquier-glm" class="section level2">
<h2>Hay tres componentes en cualquier GLM:</h2>
<p><span style="color: deepskyblue4;">Componente aleatorio:</span> se refiere a la distribución de probabilidad de la variable de respuesta (Y); por ejemplo, distribución binomial (0, 1,: Si o No: Vivo o Muerto). Nota que la variable <span class="math inline">\(Y\)</span> puede tener otra distribución incluyendo la distribución normal, lognormal, proporción, Poisson y muchos mas.</p>
<p><span style="color: blue;">Variable predictivas:</span> especifica las variables explicativas <span class="math inline">\(X_1,\ X_2,\ X_3,...X_k\)</span> en el modelo, la combinación lineal se puede expresar con la siguiente forma; por ejemplo, <span class="math inline">\(\beta_0+\beta_1\cdot x_1+\beta_2\cdot x_2+\ ...+\beta_k\cdot x_k\)</span> como hemos visto en una regresión lineal.</p>
<p><span style="color: blue;">Función de enlace:</span> η o g (μ): especifica el enlace entre componentes aleatorios y sistemáticos. Dice cómo el valor esperado de la respuesta se relaciona con las variables de la ecuación lineal explicativa.</p>
<hr />
</div>
<div id="los-supuestos-de-la-regresión-logística." class="section level2">
<h2>Los supuestos de la regresión logística.</h2>
<blockquote>
<ul>
<li>El resultado es la variable es binaria o también conocida como dicótoma (sí o no: presente o ausente, 1 o 0).</li>
<li>Existe una relación lineal entre el logit (p) de la variable de repuesta y las variables predictora.</li>
<li>No hay valores extremos o valores atípicos en los predictores continuos.</li>
<li>No hay correlaciones altas (es decir, multicolinealidad) entre los variables predictores.</li>
</ul>
</blockquote>
<hr />
</div>
<div id="evaluando-si-el-modelo-es-aceptable" class="section level2">
<h2>Evaluando si el modelo es aceptable</h2>
<blockquote>
<p>Hay muchas alternativas para evaluar si el modelo logístico es aceptable o sea que explica parte de la variación. El método típico de <span class="math inline">\(R^2\)</span> no es viable para la regresión logística, pero hay múltiples alternativas. En el siguiente enlace pueden observar algunas de estas. Pero nota que no hay uno que es necesariamente <strong>mejor</strong>, cada una de estas alternativas tiene sus ventajas y desventajas Una de las desventajas es que la escala no es como <span class="math inline">\(R^2\)</span> que varia de 0 a 1, por consecuencia sus interpretaciones son siempre más complejas.</p>
</blockquote>
<p><a href="https://www.r-bloggers.com/evaluating-logistic-regression-models/" class="uri">https://www.r-bloggers.com/evaluating-logistic-regression-models/</a></p>
<hr />
</div>
<div id="comparar-modelos-lineal-y-logístico" class="section level2">
<h2>Comparar modelos lineal y logístico</h2>
<p>El primer paso es entender la diferencia entre una regresión lineal y una regresión logística. Podemos visualizar ambas formula y ver como difieren.</p>
<p>La regresión lineal:</p>
<p><span class="math display">\[Y_i=\beta_0+\beta_1X_{1i}\beta_2X_{2i}\]</span> Regresión logística:</p>
<p><span class="math inline">\(p=P(Y=1)\)</span> o sea la probabilidad que p tenga el valor de <strong>1</strong> o <span class="math inline">\(1-p= 1-P(Y=1)\)</span> que seria el valor de <strong>0</strong> en su conjunto de datos.</p>
<p><span class="math display">\[\log\frac{p}{1-p}=\beta_0+\beta_1X_i+\beta_2X_i\]</span> Nota que la primera ecuación es un modelo que trata de predecir el valor de <strong>Y</strong> en la segunda se estima la probabilidad de que el valor de las variables predictora tenga una probabilidad entre <span class="math inline">\(0\)</span> y <span class="math inline">\(1\)</span>. Las probabilidades van a variar de <span class="math inline">\(0\)</span> a <span class="math inline">\(1\)</span> o sea de 0% a 100%. El vocabulario formal es que las respuesta son binarias o que siguen la distribución de Bernoulli.</p>
<p>En la literatura la formula también se representa como <span class="math inline">\(logit(p)\)</span>.</p>
<p><span class="math display">\[logit\left(p\right)=\log\frac{p}{1-p}=\beta_0+\beta_1X_i+\beta_2X_i\]</span></p>
<p>En el siguiente enlace se puede encontrar más información <a href="https://en.wikipedia.org/wiki/Logistic_regression" class="uri">https://en.wikipedia.org/wiki/Logistic_regression</a></p>
<hr />
</div>
</div>
<div id="primer-ejemplo" class="section level1">
<h1>Primer ejemplo</h1>
<div id="karn-and-penrose-data-set" class="section level2">
<h2>Karn and Penrose data Set</h2>
</div>
<div id="los-datos" class="section level2">
<h2>Los Datos</h2>
<p>Los datos provienen de un estudio realizado por Mary N. Karn and L. S. Penrose publicado en <strong>Annals of Eugenics</strong>, titulado <strong>Birth Weight and gestation time in relation to maternal age, parity and infant survival</strong> publicado en 1951. Estaremos usando solamente una parte de los datos. El periodo de gestación y el peso de los bebés varones al nacer y su supervivencia (falleció= 0 y sobrevivió= 1). Para facilitar el trabajo he modificado los datos un poco para cumplir con las tareas asignada.</p>
<p>El archivo “Karn_Penrose_infant_survivorship.csv” tiene datos sobre 7036 nacimientos entre los años 1935 y 1946 y tiene 4 columnas:</p>
<ul>
<li>Line_number = la secuencia de los datos</li>
<li>Gestation_Time_days = El periodo de gestación en días</li>
<li>Weigth_lb = El peso del bebe en libras</li>
<li>Surv_Index = “0” o “1”</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Karn_Penrose_infant_survivorship <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Data/Karn_Penrose_infant_survivorship.csv&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>KPdata<span class="ot">=</span>Karn_Penrose_infant_survivorship</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(KPdata)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   row_num Survival Weigth_lb Gestation_Time_days
##     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;               &lt;dbl&gt;
## 1       1        0       1                   155
## 2       2        0       1                   165
## 3       3        0       1                   165
## 4       4        0       5.5                 170
## 5       5        0       1                   180
## 6       6        0       1.5                 180</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(KPdata)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   row_num Survival Weigth_lb Gestation_Time_days
##     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;               &lt;dbl&gt;
## 1    4047        1       7                   340
## 2    4048        1       7.5                 340
## 3    4049        1       7.5                 340
## 4    4050        1       7                   345
## 5    4051        1       9                   345
## 6    4052        1      10                   345</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(KPdata)</span></code></pre></div>
<pre><code>##     row_num        Survival       Weigth_lb      Gestation_Time_days
##  Min.   :   1   Min.   :0.000   Min.   : 1.000   Min.   :155.0      
##  1st Qu.:1014   1st Qu.:1.000   1st Qu.: 6.000   1st Qu.:265.0      
##  Median :2026   Median :1.000   Median : 7.000   Median :280.0      
##  Mean   :2026   Mean   :0.923   Mean   : 7.015   Mean   :276.2      
##  3rd Qu.:3039   3rd Qu.:1.000   3rd Qu.: 8.000   3rd Qu.:295.0      
##  Max.   :4052   Max.   :1.000   Max.   :13.000   Max.   :345.0</code></pre>
<hr />
<ol style="list-style-type: decimal">
<li>Pregunta: Explique en sus propias palabras cuales son las hipótesis que se pueden probar. Específicamente mencione si la hipótesis es una hipótesis nula o alterna.</li>
</ol>
<ul>
<li><p>Hipótesis Nula: El peso de los varones y el periodo de gestación no afectan el indice de supervivencia.</p></li>
<li><p>Hipótesis Alterna #1: Los varones con un periodo de mayor gestación tienen mayor probabilidad de supervivencia que los varones con un mayor peso.</p></li>
<li><p>Hipótesis Alterna #2: Los varones con mayor peso al nacer tienen mayor probabilidad de supervivencia que los varones con un mayor periodo de gestación.</p></li>
</ul>
<hr />
<ol start="2" style="list-style-type: decimal">
<li>Pregunta: Construye una gráfica la variable de respuesta</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(KPdata)</span></code></pre></div>
<pre><code>## [1] &quot;row_num&quot;             &quot;Survival&quot;            &quot;Weigth_lb&quot;          
## [4] &quot;Gestation_Time_days&quot;</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(KPdata, <span class="fu">aes</span>(Weigth_lb))<span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span> .<span class="dv">25</span>, <span class="at">colour=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Peso de los bebe, lbs&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Frecuencia&quot;</span>)<span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Frecuencia vs Peso de los bebe, lbs&quot;</span>)</span></code></pre></div>
<p><img src="TF5_Regresion_logistica_files/figure-html/variable%20de%20respuesta-1.png" width="672" /></p>
<hr />
<ol start="3" style="list-style-type: decimal">
<li>Pregunta: Construye una gráfica la variable de las variables explicativas
<ul>
<li>Periodo de gestación</li>
<li>Peso de los varones al nacer</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(KPdata, <span class="fu">aes</span>(Gestation_Time_days))<span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span> <span class="dv">4</span>, <span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">colour=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">&quot;Duración de Gestación&quot;</span>, <span class="at">y=</span><span class="st">&quot;Frecuancia&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Frecuencia vs Duración de Gestación&quot;</span>)</span></code></pre></div>
<p><img src="TF5_Regresion_logistica_files/figure-html/periodo%20de%20gestacion-1.png" width="672" /></p>
<hr />
<p>Evaluando la distribución de la variable de respuesta</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(KPdata,<span class="fu">aes</span>(Survival))<span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">colour=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Survival&quot;</span>)<span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Count vs Survival&quot;</span>)</span></code></pre></div>
<p><img src="TF5_Regresion_logistica_files/figure-html/weight-index-1.png" width="672" /></p>
<hr />
<ol start="4" style="list-style-type: decimal">
<li>Pregunta: Usando la prueba correcta evalúa la relación entre la supervivencia y:</li>
</ol>
<ul>
<li>periodo de gestación</li>
<li>peso de los varones al nacer</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(KPdata)</span></code></pre></div>
<pre><code>## [1] &quot;row_num&quot;             &quot;Survival&quot;            &quot;Weigth_lb&quot;          
## [4] &quot;Gestation_Time_days&quot;</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>modelgest<span class="ot">&lt;-</span><span class="fu">glm</span>(Survival<span class="sc">~</span>Weigth_lb, <span class="at">data=</span> KPdata, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelgest)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Survival ~ Weigth_lb, family = binomial(), data = KPdata)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.7486   0.1921   0.2682   0.4385   1.3558  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.76189    0.22628  -7.786 6.91e-15 ***
## Weigth_lb    0.67591    0.03825  17.670  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2199.2  on 4051  degrees of freedom
## Residual deviance: 1833.2  on 4050  degrees of freedom
## AIC: 1837.2
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(KPdata, <span class="fu">aes</span>(<span class="at">x=</span>Weigth_lb, <span class="at">y=</span>Survival)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>( <span class="at">method=</span><span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>), <span class="at">se=</span>F) </span></code></pre></div>
<p><img src="TF5_Regresion_logistica_files/figure-html/Periodo%20de%20Gestacion%20y%20supervivencia-1.png" width="672" /></p>
</div>
<div id="comparando-modelos" class="section level2">
<h2>Comparando modelos</h2>
<p>En el siguiente gráfico se observan tres modelos, <span style="color: blue;">logístico</span>, <span style="color: orange;">lineal</span> y <span style="color: red;">LOESS</span>. Cada uno de estos modelos tiene sus aplicaciones en diferentes circunstancias. Si evaluamos el modelos <span style="color: orange;">lineal</span> se observa que la pendiente es positiva y que sobre pasa el 100%, donde este sugiere que hay más que un 100% de probabilidad de sobrevivir. Es claro que este modelo no es adecuado ya que es biológicamente (y matemáticamente) imposible. El modelo <span style="color: red;">LOESS</span> pudiese ser aceptable, ya que bebés que nacen con un peso muy grande también pueden tener complicaciones y por ende una menor probabilidad de sobrevivir. Es es una de las razones que se usa la cesárea para dar a luz a estos bebes (en adición que para la madre también pudiese haber complicaciones).</p>
<p>El punto importante es que como la regresión logística representa una probabilidad, la regresión está limitada a valores entre 0 y 1, incluyendo el intervalo de confianza (el intervalo no puede tener valores menos de cero ni mayor de 1). Por consecuencia las probabilidades y el intervalo de confianza se limita entre 0 y 1.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(KPdata, <span class="fu">aes</span>(<span class="at">x=</span>Weigth_lb, <span class="at">y=</span>Survival)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height=</span><span class="fl">0.10</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>( <span class="at">method=</span><span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">color=</span><span class="st">&quot;orange&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">&quot;Weight Index&quot;</span>, <span class="at">y=</span> <span class="st">&quot;Surv Probability&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Models of Male Survival Probabilities at Birth based on Weight&quot;</span>)</span></code></pre></div>
<p><img src="TF5_Regresion_logistica_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>modelweight<span class="ot">&lt;-</span> <span class="fu">glm</span>(Survival<span class="sc">~</span>Gestation_Time_days<span class="sc">+</span>Weigth_lb, <span class="at">data =</span> KPdata, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelweight)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Survival ~ Gestation_Time_days + Weigth_lb, family = binomial(), 
##     data = KPdata)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.4530   0.1919   0.2694   0.3967   1.4371  
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)         -6.478426   0.692953  -9.349  &lt; 2e-16 ***
## Gestation_Time_days  0.022551   0.003101   7.273 3.52e-13 ***
## Weigth_lb            0.462342   0.046481   9.947  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2199.2  on 4051  degrees of freedom
## Residual deviance: 1777.9  on 4049  degrees of freedom
## AIC: 1783.9
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<hr />
</div>
<div id="brassavola-cucullata" class="section level2">
<h2><em>Brassavola cucullata</em></h2>
<p>Los datos fueron recolectados de dos pequeñas islas del Caribe, San Eustaquio y Saba.</p>
<p><em>Brassavola cucullata</em> pertenece a la subtribu Laeliinae y es una especie epífita y rupícola que puede formar grandes racimos de brotes. Cada brote está compuesto por un solo tallo de 3.5-12.5 cm de largo y 1-3.5 mm de diámetro y tiene una sola hoja semi-tereta de 16-35 cm de largo y solo un poco más gruesa que el tallo. Las inflorescencias terminales miden 3-30 mm de largo y suelen tener una sola flor. Las flores son en gran parte blancas con las partes delgadas del perianto que a menudo se vuelven de color amarillo pálido hacia sus ápices. El labelo es ovado-acuminado y fimbriado alrededor de la columna. El cunículo se extiende hacia el ovario inferior y no tiene néctar. Las flores engañosas tienen una fragancia nocturna dulce y espesa, que puede perdurar hasta el día. La producción de frutos depende de los polinizadores. Las cápsulas tardan varios meses en desarrollarse y son pediceladas y picudas (restos de la columna); el cuerpo de la cápsula mide entre 2 y 5 cm de largo y produce muchos miles de semillas polvorientas (Ackerman y Collaborators 2014).</p>
<p>En cada una de las tres poblaciones, etiquetamos todas las plantas de <em>B. cucullata</em> que pudimos encontrar. Observamos si cada planta era epífita o epilítica, medimos la altura sobre el suelo, buscamos evidencia de herbivoría foliar, medimos la longitud de la hoja más larga y contamos el número de brotes de hojas, flores y frutos. Si las flores estaban presentes, registramos si habían sido visitadas con éxito o no mediante una inspección visual para la eliminación de polinarios o polinias en el estigma. Estos datos se obtuvieron una vez al año durante la época de floración. Nuestras observaciones en la población de Quill abarcaron 2009-2013, en Boven 2010-2013 y en Saba 2011-2014.</p>
<div class="figure">
<img src="Graficos/Brass_cucu1.png" alt="**La especie** *Brasavolla cucullata* **en la isla de San Eustaquio**" width="40%" /><img src="Graficos/Brass_cucu2.png" alt="**La especie** *Brasavolla cucullata* **en la isla de San Eustaquio**" width="40%" />
<p class="caption">
<strong>La especie</strong> <em>Brasavolla cucullata</em> <strong>en la isla de San Eustaquio</strong>
</p>
</div>
<hr />
<p>Puede encontrar el manuscrito en este enlace, que evalúa la biología de la orquídea y la posibilidad de extinción y como las cabras impacta su supervivencias.</p>
<p><a href="https://www.journals.uchicago.edu/doi/pdf/10.1086/709399" class="uri">https://www.journals.uchicago.edu/doi/pdf/10.1086/709399</a></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>Student_Brassavola <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Data/Student_Brassavola.csv&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>completeBrass<span class="ot">=</span><span class="fu">na.omit</span>(Student_Brassavola)  <span class="co"># remove NA</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(completeBrass)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 10
##   Island  Year Pl_Num Leaf_Num   LLL Bud_Num Fl_Num Fr_Num BQS   Flowers_Y_N
##   &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;
## 1 Saba    2011 A1701        20    26       0      1      0 Saba            1
## 2 Saba    2011 A1702         6    18       0      0      0 Saba            0
## 3 Saba    2011 A1703         5    13       0      0      0 Saba            0
## 4 Statia  2010 102          33    31       0      0      0 Boven           0
## 5 Statia  2011 102          40    34       0      0      0 Boven           0
## 6 Statia  2012 102          10    23       0      1      0 Boven           1</code></pre>
<p>Evaluar la tendencias centrales y la dispersión de las variables y cambio de nombre de las variables al español.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Brass<span class="ot">=</span>completeBrass<span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Isla=</span>Island, Año<span class="ot">=</span>Year, <span class="at">Numero_planta=</span>Pl_Num, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Cant_hojas=</span>Leaf_Num, <span class="at">Largo_Hoja_cm=</span>LLL, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Cant_capullo=</span>Bud_Num, <span class="at">Cant_Flores=</span>Fl_Num, </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Cant_Frutos=</span>Fr_Num, <span class="at">BQS=</span>BQS, <span class="at">Flor_si_no=</span>Flowers_Y_N)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Brass <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>##      Isla                Año       Numero_planta        Cant_hojas    
##  Length:1436        Min.   :2009   Length:1436        Min.   :  0.00  
##  Class :character   1st Qu.:2011   Class :character   1st Qu.:  3.00  
##  Mode  :character   Median :2011   Mode  :character   Median :  7.00  
##                     Mean   :2011                      Mean   : 16.66  
##                     3rd Qu.:2012                      3rd Qu.: 17.00  
##                     Max.   :2014                      Max.   :336.00  
##  Largo_Hoja_cm     Cant_capullo      Cant_Flores      Cant_Frutos     
##  Min.   :  0.00   Min.   :0.00000   Min.   :0.0000   Min.   :0.00000  
##  1st Qu.:  8.50   1st Qu.:0.00000   1st Qu.:0.0000   1st Qu.:0.00000  
##  Median : 19.00   Median :0.00000   Median :0.0000   Median :0.00000  
##  Mean   : 18.12   Mean   :0.05153   Mean   :0.1247   Mean   :0.04735  
##  3rd Qu.: 26.00   3rd Qu.:0.00000   3rd Qu.:0.0000   3rd Qu.:0.00000  
##  Max.   :108.00   Max.   :4.00000   Max.   :7.0000   Max.   :3.00000  
##      BQS              Flor_si_no     
##  Length:1436        Min.   :0.00000  
##  Class :character   1st Qu.:0.00000  
##  Mode  :character   Median :0.00000  
##                     Mean   :0.08705  
##                     3rd Qu.:0.00000  
##                     Max.   :1.00000</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Preguntas:</li>
</ol>
<ul>
<li>¿Cual fue el primer año de muestreo?</li>
<li>¿Cual es promedio, mediana de plantas con flores?</li>
<li>¿Cual es promedio, mediana de plantas con frutos?</li>
<li>¿Cual es la plantas más grande considerando la cantidad de hojas?</li>
<li>¿Cual es la hoja más grande, cm?</li>
</ul>
<hr />
</div>
<div id="la-variable-de-respuesta-y." class="section level2">
<h2>La variable de respuesta, <strong>Y</strong>.</h2>
<p><img src="TF5_Regresion_logistica_files/figure-html/head-1.png" width="672" /></p>
<hr />
</div>
<div id="tres-modelos" class="section level2">
<h2>Tres modelos:</h2>
<blockquote>
<p>la probabilidad de tener flores es relacionado a la cantidad de hojas (el tamaño de la planta).</p>
<p>la probabilidad de tener flores es relacionado a la hoja más larga de la planta (el tamaño de la planta).</p>
<p>la probabilidad de tener flores es relacionado a la hoja más larga de la planta y a la cantidad de hojas.</p>
</blockquote>
</div>
</div>
<div id="generalized-linear-model-glm" class="section level1">
<h1>Generalized Linear Model = glm</h1>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>BrassModel<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(Flor_si_no <span class="sc">~</span> Cant_hojas,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> Brass, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BrassModel<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Flor_si_no ~ Cant_hojas, family = binomial(), data = Brass)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2129  -0.3608  -0.3212  -0.3120   2.4571  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -3.088221   0.134013  -23.04   &lt;2e-16 ***
## Cant_hojas   0.029925   0.002987   10.02   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 849.11  on 1435  degrees of freedom
## Residual deviance: 722.57  on 1434  degrees of freedom
## AIC: 726.57
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>BrassModel<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(Flor_si_no <span class="sc">~</span> Largo_Hoja_cm,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> Brass, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BrassModel<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Flor_si_no ~ Largo_Hoja_cm, family = binomial(), 
##     data = Brass)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.8476  -0.4723  -0.2920  -0.1568   2.8322  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -4.96559    0.33283 -14.919   &lt;2e-16 ***
## Largo_Hoja_cm  0.11451    0.01199   9.553   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 849.11  on 1435  degrees of freedom
## Residual deviance: 722.30  on 1434  degrees of freedom
## AIC: 726.3
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>BrassModel<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(Flor_si_no <span class="sc">~</span> Cant_hojas<span class="sc">+</span>Largo_Hoja_cm,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> Brass, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BrassModel<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Flor_si_no ~ Cant_hojas + Largo_Hoja_cm, family = binomial(), 
##     data = Brass)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.3168  -0.4122  -0.2754  -0.1728   2.4903  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -4.673981   0.330208 -14.155  &lt; 2e-16 ***
## Cant_hojas     0.019103   0.003132   6.100 1.06e-09 ***
## Largo_Hoja_cm  0.080198   0.013034   6.153 7.60e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 849.11  on 1435  degrees of freedom
## Residual deviance: 677.99  on 1433  degrees of freedom
## AIC: 683.99
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<hr />
</div>
<div id="remover-el-intercepto" class="section level1">
<h1>Remover el intercepto</h1>
<p>Si no le interesa el intercepto se añade un “-1” después de la ultima variable predictora. Los valores de interés en nuestro caso son el intercepto y la pendiente (valor que se encuentra debajo del intercepto).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Brass)</span></code></pre></div>
<pre><code>##  [1] &quot;Isla&quot;          &quot;Año&quot;           &quot;Numero_planta&quot; &quot;Cant_hojas&quot;   
##  [5] &quot;Largo_Hoja_cm&quot; &quot;Cant_capullo&quot;  &quot;Cant_Flores&quot;   &quot;Cant_Frutos&quot;  
##  [9] &quot;BQS&quot;           &quot;Flor_si_no&quot;</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>BrassModel.<span class="fl">1.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(Flor_si_no <span class="sc">~</span> Cant_hojas<span class="sc">+</span>BQS<span class="sc">+</span>Largo_Hoja_cm<span class="dv">-1</span>,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> Brass, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BrassModel.<span class="fl">1.1</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Flor_si_no ~ Cant_hojas + BQS + Largo_Hoja_cm - 
##     1, family = binomial(), data = Brass)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.2232  -0.4090  -0.2656  -0.1737   2.5854  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## Cant_hojas     0.020693   0.003221   6.425 1.31e-10 ***
## BQSBoven      -5.425491   0.428570 -12.660  &lt; 2e-16 ***
## BQSQuill      -4.704079   0.392591 -11.982  &lt; 2e-16 ***
## BQSSaba       -4.586157   0.328376 -13.966  &lt; 2e-16 ***
## Largo_Hoja_cm  0.083145   0.013310   6.247 4.19e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1990.72  on 1436  degrees of freedom
## Residual deviance:  668.85  on 1431  degrees of freedom
## AIC: 678.85
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<hr />
</div>
<div id="predecir-el-número-de-frutos" class="section level1">
<h1>Predecir el número de frutos:</h1>
<p>Usando la ecuación que sigue, utilizando los resultados del modelo anterior</p>
<p><span class="math display">\[P(Y)\quad =\quad \frac { 1 }{ 1+{ e }^{ -(b+m\cdot { x }_{ i }) } }\]</span> <span class="math display">\[P(Y)\quad =\quad \frac { 1 }{ 1+{ e }^{ -((intercepto)+pendiente*variable.predictora) } }\]</span></p>
</div>
<div id="se-usa-esta-ecuacion-para-predecir-un-valor-de-y-especifico-para-un-valor-de-en-la-variable-x." class="section level1">
<h1>Se usa esta ecuacion para predecir un valor de ‘Y’ especifico para un valor de en la variable ‘x’.</h1>
<p>Por ejemplo para el primer modelo, donde se evalúa la cantidad de hojas y la probabilidad de tener una flor, e; resultado es lo siguiente. Aplicando la formula anterior para plantas que tiene 10, 25, 50, 70 y 150 hojas. Se puede observar las probabilidades de tener un fruto.</p>
<ul>
<li>P_10 = 0.05907809</li>
<li>P_25 = 0.08927658</li>
<li>P_50 = 0.1707955</li>
<li>P_70 = 0.2717029</li>
<li>P_150 = 0.8005922</li>
</ul>
<blockquote>
<p>summary(BrassModel.1) Coefficients: Estimate Std. Error z value Pr(&gt;|z|)<br />
(Intercept) -3.088221 0.134013 -23.04 &lt;2e-16 <strong><em> Cant_hojas 0.029925 0.002987 10.02 &lt;2e-16 </em></strong></p>
</blockquote>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exp(1) #=e</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>e<span class="ot">=</span> <span class="fu">exp</span>(<span class="dv">1</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># P_10=1/(1+2.7182818284^-(-3.065 +0.0297*150)) Una opción</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># P_10</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>P_10<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^-</span>(<span class="sc">-</span><span class="fl">3.065</span> <span class="sc">+</span><span class="fl">0.0297</span><span class="sc">*</span><span class="dv">10</span>)) </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>P_10</span></code></pre></div>
<pre><code>## [1] 0.05907809</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>P_25<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>(<span class="sc">-</span><span class="fl">3.065</span> <span class="sc">+</span><span class="fl">0.0297</span><span class="sc">*</span><span class="dv">25</span>)))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>P_25</span></code></pre></div>
<pre><code>## [1] 0.08927658</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>P_50<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>e<span class="sc">^-</span>(<span class="sc">-</span><span class="fl">3.065</span> <span class="sc">+</span><span class="fl">0.0297</span><span class="sc">*</span><span class="dv">50</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>P_50</span></code></pre></div>
<pre><code>## [1] 0.1707955</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>P_70<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>e<span class="sc">^-</span>(<span class="sc">-</span><span class="fl">3.065</span> <span class="sc">+</span><span class="fl">0.0297</span><span class="sc">*</span><span class="dv">70</span>))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>P_70</span></code></pre></div>
<pre><code>## [1] 0.2717029</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>P_150<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>e<span class="sc">^-</span>(<span class="sc">-</span><span class="fl">3.065</span> <span class="sc">+</span><span class="fl">0.0297</span><span class="sc">*</span><span class="dv">150</span>))</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>P_150</span></code></pre></div>
<pre><code>## [1] 0.8005922</code></pre>
<div id="visualizando-una-regresión-logistica" class="section level2">
<h2>Visualizando una regresión logistica</h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Brass)</span></code></pre></div>
<pre><code>##  [1] &quot;Isla&quot;          &quot;Año&quot;           &quot;Numero_planta&quot; &quot;Cant_hojas&quot;   
##  [5] &quot;Largo_Hoja_cm&quot; &quot;Cant_capullo&quot;  &quot;Cant_Flores&quot;   &quot;Cant_Frutos&quot;  
##  [9] &quot;BQS&quot;           &quot;Flor_si_no&quot;</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(Brass, <span class="fu">aes</span>(Cant_hojas,Flor_si_no))<span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="TF5_Regresion_logistica_files/figure-html/ggplot%20binomial-1.png" width="672" /></p>
</div>
<div id="reducir-solapamiento-de-los-puntos" class="section level2">
<h2>Reducir solapamiento de los puntos</h2>
<p>Usar geom_jitter, y las opciones son las siguientes</p>
<p>ggplot(el archivo de datos, aes(las variables continuas))<br />
• geom jitter(alpha, color, fill, shape, size)<br />
◦ alpha: la intensidad del color ◦ color: el color de la línea alrededor de las barras ◦ fill: el color de las barras ◦ linetype: representa el estilo de línea; ver sección “Especificación Estética” ◦ size: representa el grosor de la línea ◦ weight: para modificar el valor original; entonces no sería, por ejemplo, el conteo/suma de los valores si no un valor ponderado (promedio ponderado) ◦ height: para definir el rango del jitter, más grande más espacio hay entre los valores en el eje de <strong>y</strong>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Brass, <span class="fu">aes</span>(Cant_hojas,Flor_si_no))<span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.10</span>)</span></code></pre></div>
<p><img src="TF5_Regresion_logistica_files/figure-html/jitter-1.png" width="672" /></p>
</div>
</div>
<div id="graphic-with-binomial-fit" class="section level1">
<h1>Graphic with binomial fit</h1>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Brass)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 10
##   Isla     Año Numero_planta Cant_hojas Largo_Hoja_cm Cant_capullo Cant_Flores
##   &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1 Saba    2011 A1701                 20            26            0           1
## 2 Saba    2011 A1702                  6            18            0           0
## 3 Saba    2011 A1703                  5            13            0           0
## 4 Statia  2010 102                   33            31            0           0
## 5 Statia  2011 102                   40            34            0           0
## 6 Statia  2012 102                   10            23            0           1
## # … with 3 more variables: Cant_Frutos &lt;dbl&gt;, BQS &lt;chr&gt;, Flor_si_no &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Brass, <span class="fu">aes</span>(Cant_hojas,Flor_si_no,<span class="at">colour=</span>BQS))<span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.10</span>, <span class="at">alpha=</span>.<span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;glm&quot;</span>, <span class="at">se=</span><span class="cn">TRUE</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>))</span></code></pre></div>
<p><img src="TF5_Regresion_logistica_files/figure-html/binomial%20fit-1.png" width="672" /></p>
<p>El modelo de regresión logística</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BrassModel<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Flor_si_no ~ Cant_hojas, family = binomial(), data = Brass)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2129  -0.3608  -0.3212  -0.3120   2.4571  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -3.088221   0.134013  -23.04   &lt;2e-16 ***
## Cant_hojas   0.029925   0.002987   10.02   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 849.11  on 1435  degrees of freedom
## Residual deviance: 722.57  on 1434  degrees of freedom
## AIC: 726.57
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>En este gráfico se observa el valor de la pendiente, el mismo aumenta cuando el numero de hojas se aproxima a 100 (por ende al acercarnos a este valor el valor de nuestra variable de respuesta es mayor aumenta o es mayor).</p>
<div id="crear-una-figura-por-cada-sitio-de-muestreo" class="section level2">
<h2>Crear una figura por cada sitio de muestreo</h2>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Brass)</span></code></pre></div>
<pre><code>##  [1] &quot;Isla&quot;          &quot;Año&quot;           &quot;Numero_planta&quot; &quot;Cant_hojas&quot;   
##  [5] &quot;Largo_Hoja_cm&quot; &quot;Cant_capullo&quot;  &quot;Cant_Flores&quot;   &quot;Cant_Frutos&quot;  
##  [9] &quot;BQS&quot;           &quot;Flor_si_no&quot;</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Brass, <span class="fu">aes</span>(Cant_hojas,Flor_si_no))<span class="sc">+</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">&quot;glm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>))<span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Isla)</span></code></pre></div>
<p><img src="TF5_Regresion_logistica_files/figure-html/facet-1.png" width="672" /></p>
</div>
<div id="solapamiento-de-gráficos" class="section level2">
<h2>Solapamiento de gráficos</h2>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Brass)</span></code></pre></div>
<pre><code>##  [1] &quot;Isla&quot;          &quot;Año&quot;           &quot;Numero_planta&quot; &quot;Cant_hojas&quot;   
##  [5] &quot;Largo_Hoja_cm&quot; &quot;Cant_capullo&quot;  &quot;Cant_Flores&quot;   &quot;Cant_Frutos&quot;  
##  [9] &quot;BQS&quot;           &quot;Flor_si_no&quot;</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Brass, <span class="fu">aes</span>(Cant_hojas,Flor_si_no))<span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">&quot;glm&quot;</span>, <span class="at">se=</span><span class="cn">TRUE</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>))</span></code></pre></div>
<p><img src="TF5_Regresion_logistica_files/figure-html/overlap%20by%20site-1.png" width="672" /></p>
</div>
</div>
<div id="evaluate-using-the-length-of-the-longest-leaf" class="section level1">
<h1>Evaluate using the Length of the longest leaf</h1>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Brass)</span></code></pre></div>
<pre><code>##  [1] &quot;Isla&quot;          &quot;Año&quot;           &quot;Numero_planta&quot; &quot;Cant_hojas&quot;   
##  [5] &quot;Largo_Hoja_cm&quot; &quot;Cant_capullo&quot;  &quot;Cant_Flores&quot;   &quot;Cant_Frutos&quot;  
##  [9] &quot;BQS&quot;           &quot;Flor_si_no&quot;</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Brass, <span class="fu">aes</span>(Largo_Hoja_cm,Flor_si_no))<span class="sc">+</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img src="TF5_Regresion_logistica_files/figure-html/LLL-1.png" width="672" /></p>
<hr />
<div id="rmover-datos-sesgados-probablemente-un-valor-entrado-equivocadamente" class="section level3">
<h3>Rmover datos sesgados (probablemente un valor entrado equivocadamente)</h3>
<div id="nota-que-se-hacer-un-subgrupo-subset-de-los-datos-usando-la-función-subsetel-data-frame-la-condición" class="section level4">
<h4>Nota que se hacer un subgrupo (subset) de los datos, usando la función subset(el data frame, la condición)</h4>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Brass)</span></code></pre></div>
<pre><code>##  [1] &quot;Isla&quot;          &quot;Año&quot;           &quot;Numero_planta&quot; &quot;Cant_hojas&quot;   
##  [5] &quot;Largo_Hoja_cm&quot; &quot;Cant_capullo&quot;  &quot;Cant_Flores&quot;   &quot;Cant_Frutos&quot;  
##  [9] &quot;BQS&quot;           &quot;Flor_si_no&quot;</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(Brass,Largo_Hoja_cm<span class="sc">&lt;</span><span class="dv">90</span>), <span class="fu">aes</span>(Largo_Hoja_cm,Flor_si_no, <span class="at">colour=</span>Isla))<span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.10</span>)<span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">&quot;glm&quot;</span>, <span class="at">se=</span><span class="cn">TRUE</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>))</span></code></pre></div>
<p><img src="TF5_Regresion_logistica_files/figure-html/LLL90-1.png" width="672" /></p>
<hr />
</div>
</div>
<div id="selecionar-el-mejor-modelo" class="section level2">
<h2>Selecionar el mejor modelo</h2>
<p>Vea modulo <strong>Criterio de Información</strong></p>
<hr />
<p><img src="Graficos/UPR_Logos.png" width="100%" /> &gt; “Activities reported in this website was supported by the National Institute of General Medical Sciences of the National Institutes of Health under Award Number R25GM121270. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.”</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
